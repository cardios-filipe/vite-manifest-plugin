{"version":3,"sources":["../src/utils.ts","../src/index.ts"],"sourcesContent":["import { writeFileSync } from 'fs';\r\nimport { resolve } from 'path';\r\nimport { readFile } from 'fs/promises';\r\n\r\nimport { ManifestOptions } from \"./types\";\r\n\r\nexport const modifiedManifest = async (outputPath: string | undefined, options: ManifestOptions): Promise<void> => {\r\n  try {\r\n    const manifestPath = resolve(`${outputPath ?? \"\"}/${options.fileName}`);\r\n    const manifest = JSON.parse(await readFile(manifestPath, 'utf-8'));\r\n\r\n    for (const key in manifest) {\r\n      if (Object.prototype.hasOwnProperty.call(manifest, key)) {\r\n        manifest[key].file = `${options.publicPath ?? \"/\"}${manifest[key].file}`;\r\n\r\n        if(manifest[key].hasOwnProperty('css')) {\r\n          for (const cssKey in manifest[key].css) {\r\n            manifest[key].css[cssKey] = `${options.publicPath ?? \"/\"}${manifest[key].css[cssKey]}`;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (manifest['index.html']) {\r\n      var newCss = []\r\n      for (var idx in manifest['index.html'].css) {\r\n        newCss.push(`${options.publicPath ?? \"/\"}${manifest['index.html'].css[idx]}`)\r\n      }\r\n      manifest['index.html'].css = newCss\r\n    }\r\n\r\n    writeFileSync(manifestPath, JSON.stringify(manifest, null, 2));\r\n  } catch (error) {\r\n    console.error('An error occurred:', error);\r\n    // Continue running the program\r\n  }\r\n}","import { Plugin } from \"vite\"\r\nimport { ManifestOptions } from \"./types\"\r\nimport { modifiedManifest } from \"./utils\"\r\n\r\nexport const viteManifestPlugin = async (options: ManifestOptions): Promise<Plugin<any>> => {\r\n  const plugin: Plugin = {\r\n    name: 'vite-manifest-plugin',\r\n    enforce: 'post',\r\n    apply: 'build',\r\n    async writeBundle({ dir }) {\r\n      await modifiedManifest(dir, options)\r\n    },\r\n  }\r\n\r\n  return plugin;\r\n}"],"mappings":"6MAAA,OAAS,iBAAAA,MAAqB,KAC9B,OAAS,WAAAC,MAAe,OACxB,OAAS,YAAAC,MAAgB,cAIlB,IAAMC,EAAmB,CAAOC,EAAgCC,IAA4CC,EAAA,wBANnH,IAAAC,EAAAC,EAAAC,EAOE,GAAI,CACF,IAAMC,EAAeC,EAAQ,GAAGP,GAAA,KAAAA,EAAc,EAAE,IAAIC,EAAQ,QAAQ,EAAE,EAChEO,EAAW,KAAK,MAAM,MAAMC,EAASH,EAAc,OAAO,CAAC,EAEjE,QAAWI,KAAOF,EAChB,GAAI,OAAO,UAAU,eAAe,KAAKA,EAAUE,CAAG,IACpDF,EAASE,CAAG,EAAE,KAAO,IAAGP,EAAAF,EAAQ,aAAR,KAAAE,EAAsB,GAAG,GAAGK,EAASE,CAAG,EAAE,IAAI,GAEnEF,EAASE,CAAG,EAAE,eAAe,KAAK,GACnC,QAAWC,KAAUH,EAASE,CAAG,EAAE,IACjCF,EAASE,CAAG,EAAE,IAAIC,CAAM,EAAI,IAAGP,EAAAH,EAAQ,aAAR,KAAAG,EAAsB,GAAG,GAAGI,EAASE,CAAG,EAAE,IAAIC,CAAM,CAAC,GAM5F,GAAIH,EAAS,YAAY,EAAG,CAC1B,IAAII,EAAS,CAAC,EACd,QAASC,KAAOL,EAAS,YAAY,EAAE,IACrCI,EAAO,KAAK,IAAGP,EAAAJ,EAAQ,aAAR,KAAAI,EAAsB,GAAG,GAAGG,EAAS,YAAY,EAAE,IAAIK,CAAG,CAAC,EAAE,EAE9EL,EAAS,YAAY,EAAE,IAAMI,CAC/B,CAEAE,EAAcR,EAAc,KAAK,UAAUE,EAAU,KAAM,CAAC,CAAC,CAC/D,OAASO,EAAO,CACd,QAAQ,MAAM,qBAAsBA,CAAK,CAE3C,CACF,GChCO,IAAMC,EAA4BC,GAAmDC,EAAA,wBAU1F,MATuB,CACrB,KAAM,uBACN,QAAS,OACT,MAAO,QACD,YAAYC,EAAS,QAAAD,EAAA,yBAAT,CAAE,IAAAE,CAAI,EAAG,CACzB,MAAMC,EAAiBD,EAAKH,CAAO,CACrC,GACF,CAGF","names":["writeFileSync","resolve","readFile","modifiedManifest","outputPath","options","__async","_a","_b","_c","manifestPath","resolve","manifest","readFile","key","cssKey","newCss","idx","writeFileSync","error","viteManifestPlugin","options","__async","_0","dir","modifiedManifest"]}
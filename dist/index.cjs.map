{"version":3,"sources":["../src/index.ts","../src/utils.ts"],"sourcesContent":["import { Plugin } from \"vite\"\r\nimport { ManifestOptions } from \"./types\"\r\nimport { modifiedManifest } from \"./utils\"\r\n\r\nexport const viteManifestPlugin = async (options: ManifestOptions): Promise<Plugin<any>> => {\r\n  const plugin: Plugin = {\r\n    name: 'vite-manifest-plugin',\r\n    enforce: 'post',\r\n    apply: 'build',\r\n    async writeBundle({ dir }) {\r\n      await modifiedManifest(dir, options)\r\n    },\r\n  }\r\n\r\n  return plugin;\r\n}","import { writeFileSync } from 'fs';\r\nimport { resolve } from 'path';\r\nimport { readFile } from 'fs/promises';\r\n\r\nimport { ManifestOptions } from \"./types\";\r\n\r\nexport const modifiedManifest = async (outputPath: string | undefined, options: ManifestOptions): Promise<void> => {\r\n  try {\r\n    const manifestPath = resolve(`${outputPath ?? \"\"}/${options.fileName}`);\r\n    const manifest = JSON.parse(await readFile(manifestPath, 'utf-8'));\r\n\r\n    for (const key in manifest) {\r\n      if (Object.prototype.hasOwnProperty.call(manifest, key)) {\r\n        manifest[key].file = `${options.publicPath ?? \"/\"}${manifest[key].file}`;\r\n\r\n        if(manifest[key].hasOwnProperty('css')) {\r\n          for (const cssKey in manifest[key].css) {\r\n            manifest[key].css[cssKey] = `${options.publicPath ?? \"/\"}${manifest[key].css[cssKey]}`;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (manifest['index.html']) {\r\n      var newCss = []\r\n      for (var idx in manifest['index.html'].css) {\r\n        newCss.push(`${options.publicPath ?? \"/\"}${manifest['index.html'].css[idx]}`)\r\n      }\r\n      manifest['index.html'].css = newCss\r\n    }\r\n\r\n    writeFileSync(manifestPath, JSON.stringify(manifest, null, 2));\r\n  } catch (error) {\r\n    console.error('An error occurred:', error);\r\n    // Continue running the program\r\n  }\r\n}"],"mappings":"snBAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,wBAAAE,IAAA,eAAAC,EAAAH,GCAA,IAAAI,EAA8B,cAC9BC,EAAwB,gBACxBC,EAAyB,uBAIlB,IAAMC,EAAmB,CAAOC,EAAgCC,IAA4CC,EAAA,wBANnH,IAAAC,EAAAC,EAAAC,EAOE,GAAI,CACF,IAAMC,KAAe,WAAQ,GAAGN,GAAA,KAAAA,EAAc,EAAE,IAAIC,EAAQ,QAAQ,EAAE,EAChEM,EAAW,KAAK,MAAM,QAAM,YAASD,EAAc,OAAO,CAAC,EAEjE,QAAWE,KAAOD,EAChB,GAAI,OAAO,UAAU,eAAe,KAAKA,EAAUC,CAAG,IACpDD,EAASC,CAAG,EAAE,KAAO,IAAGL,EAAAF,EAAQ,aAAR,KAAAE,EAAsB,GAAG,GAAGI,EAASC,CAAG,EAAE,IAAI,GAEnED,EAASC,CAAG,EAAE,eAAe,KAAK,GACnC,QAAWC,KAAUF,EAASC,CAAG,EAAE,IACjCD,EAASC,CAAG,EAAE,IAAIC,CAAM,EAAI,IAAGL,EAAAH,EAAQ,aAAR,KAAAG,EAAsB,GAAG,GAAGG,EAASC,CAAG,EAAE,IAAIC,CAAM,CAAC,GAM5F,GAAIF,EAAS,YAAY,EAAG,CAC1B,IAAIG,EAAS,CAAC,EACd,QAASC,KAAOJ,EAAS,YAAY,EAAE,IACrCG,EAAO,KAAK,IAAGL,EAAAJ,EAAQ,aAAR,KAAAI,EAAsB,GAAG,GAAGE,EAAS,YAAY,EAAE,IAAII,CAAG,CAAC,EAAE,EAE9EJ,EAAS,YAAY,EAAE,IAAMG,CAC/B,IAEA,iBAAcJ,EAAc,KAAK,UAAUC,EAAU,KAAM,CAAC,CAAC,CAC/D,OAASK,EAAO,CACd,QAAQ,MAAM,qBAAsBA,CAAK,CAE3C,CACF,GDhCO,IAAMC,EAA4BC,GAAmDC,EAAA,wBAU1F,MATuB,CACrB,KAAM,uBACN,QAAS,OACT,MAAO,QACD,YAAYC,EAAS,QAAAD,EAAA,yBAAT,CAAE,IAAAE,CAAI,EAAG,CACzB,MAAMC,EAAiBD,EAAKH,CAAO,CACrC,GACF,CAGF","names":["index_exports","__export","viteManifestPlugin","__toCommonJS","import_fs","import_path","import_promises","modifiedManifest","outputPath","options","__async","_a","_b","_c","manifestPath","manifest","key","cssKey","newCss","idx","error","viteManifestPlugin","options","__async","_0","dir","modifiedManifest"]}